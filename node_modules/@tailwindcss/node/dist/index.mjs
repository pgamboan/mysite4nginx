var me=Object.defineProperty;var pe=(e,t)=>{for(var s in t)me(e,s,{get:t[s],enumerable:!0})};import*as k from"node:module";import{pathToFileURL as st}from"node:url";var W={};pe(W,{DEBUG:()=>ge});var ge=he(process.env.DEBUG);function he(e){if(e===void 0)return!1;if(e==="true"||e==="1")return!0;if(e==="false"||e==="0")return!1;if(e==="*")return!0;let t=e.split(",").map(s=>s.split(":")[0]);return t.includes("-tailwindcss")?!1:!!t.includes("tailwindcss")}import A from"enhanced-resolve";import{createJiti as Ke}from"jiti";import L from"node:fs";import ae from"node:fs/promises";import I,{dirname as se}from"node:path";import{pathToFileURL as ne}from"node:url";import{__unstable__loadDesignSystem as Je,compile as qe,compileAst as He,Features as Qe}from"tailwindcss";import N from"node:fs/promises";import y from"node:path";var Ae=[/import[\s\S]*?['"](.{3,}?)['"]/gi,/import[\s\S]*from[\s\S]*?['"](.{3,}?)['"]/gi,/export[\s\S]*from[\s\S]*?['"](.{3,}?)['"]/gi,/require\(['"`](.+)['"`]\)/gi],ye=[".js",".cjs",".mjs"],xe=["",".js",".cjs",".mjs",".ts",".cts",".mts",".jsx",".tsx"],Re=["",".ts",".cts",".mts",".tsx",".js",".cjs",".mjs",".jsx"];async function we(e,t){for(let s of t){let r=`${e}${s}`;if((await N.stat(r).catch(()=>null))?.isFile())return r}for(let s of t){let r=`${e}/index${s}`;if(await N.access(r).then(()=>!0,()=>!1))return r}return null}async function B(e,t,s,r){let n=ye.includes(r)?xe:Re,i=await we(y.resolve(s,t),n);if(i===null||e.has(i))return;e.add(i),s=y.dirname(i),r=y.extname(i);let o=await N.readFile(i,"utf-8"),a=[];for(let l of Ae)for(let c of o.matchAll(l))c[1].startsWith(".")&&a.push(B(e,c[1],s,r));await Promise.all(a)}async function z(e){let t=new Set;return await B(t,e,y.dirname(e),y.extname(e)),Array.from(t)}import*as T from"node:path";var x=92,C=47,S=42,Ce=34,Se=39,ve=58,v=59,g=10,R=32,E=9,G=123,$=125,D=40,K=41,Ee=91,_e=93,J=45,b=64,ke=33;function q(e){e=e.replaceAll(`\r
`,`
`);let t=[],s=[],r=[],n=null,i=null,o="",a="",l;for(let c=0;c<e.length;c++){let f=e.charCodeAt(c);if(f===x)o+=e.slice(c,c+2),c+=1;else if(f===C&&e.charCodeAt(c+1)===S){let u=c;for(let p=c+2;p<e.length;p++)if(l=e.charCodeAt(p),l===x)p+=1;else if(l===S&&e.charCodeAt(p+1)===C){c=p+1;break}let d=e.slice(u,c+1);d.charCodeAt(2)===ke&&s.push(Y(d.slice(2,-2)))}else if(f===Se||f===Ce){let u=c;for(let d=c+1;d<e.length;d++)if(l=e.charCodeAt(d),l===x)d+=1;else if(l===f){c=d;break}else{if(l===v&&e.charCodeAt(d+1)===g)throw new Error(`Unterminated string: ${e.slice(u,d+1)+String.fromCharCode(f)}`);if(l===g)throw new Error(`Unterminated string: ${e.slice(u,d)+String.fromCharCode(f)}`)}o+=e.slice(u,c+1)}else{if((f===R||f===g||f===E)&&(l=e.charCodeAt(c+1))&&(l===R||l===g||l===E))continue;if(f===g){if(o.length===0)continue;l=o.charCodeAt(o.length-1),l!==R&&l!==g&&l!==E&&(o+=" ")}else if(f===J&&e.charCodeAt(c+1)===J&&o.length===0){let u="",d=c,p=-1;for(let m=c+2;m<e.length;m++)if(l=e.charCodeAt(m),l===x)m+=1;else if(l===C&&e.charCodeAt(m+1)===S){for(let h=m+2;h<e.length;h++)if(l=e.charCodeAt(h),l===x)h+=1;else if(l===S&&e.charCodeAt(h+1)===C){m=h+1;break}}else if(p===-1&&l===ve)p=o.length+m-d;else if(l===v&&u.length===0){o+=e.slice(d,m),c=m;break}else if(l===D)u+=")";else if(l===Ee)u+="]";else if(l===G)u+="}";else if((l===$||e.length-1===m)&&u.length===0){c=m-1,o+=e.slice(d,m);break}else(l===K||l===_e||l===$)&&u.length>0&&e[m]===u[u.length-1]&&(u=u.slice(0,-1));let M=P(o,p);n?n.nodes.push(M):t.push(M),o=""}else if(f===v&&o.charCodeAt(0)===b)i=w(o),n?n.nodes.push(i):t.push(i),o="",i=null;else if(f===v&&a[a.length-1]!==")"){let u=P(o);n?n.nodes.push(u):t.push(u),o=""}else if(f===G&&a[a.length-1]!==")")a+="}",i=H(o.trim()),n&&n.nodes.push(i),r.push(n),n=i,o="",i=null;else if(f===$&&a[a.length-1]!==")"){if(a==="")throw new Error("Missing opening {");if(a=a.slice(0,-1),o.length>0)if(o.charCodeAt(0)===b)i=w(o),n?n.nodes.push(i):t.push(i),o="",i=null;else{let d=o.indexOf(":");n&&n.nodes.push(P(o,d))}let u=r.pop()??null;u===null&&n&&t.push(n),n=u,o="",i=null}else if(f===D)a+=")",o+="(";else if(f===K){if(a[a.length-1]!==")")throw new Error("Missing opening (");a=a.slice(0,-1),o+=")"}else{if(o.length===0&&(f===R||f===g||f===E))continue;o+=String.fromCharCode(f)}}}if(o.charCodeAt(0)===b&&t.push(w(o)),a.length>0&&n){if(n.kind==="rule")throw new Error(`Missing closing } at ${n.selector}`);if(n.kind==="at-rule")throw new Error(`Missing closing } at ${n.name} ${n.params}`)}return s.length>0?s.concat(t):t}function w(e,t=[]){for(let s=5;s<e.length;s++){let r=e.charCodeAt(s);if(r===R||r===D){let n=e.slice(0,s).trim(),i=e.slice(s).trim();return U(n,i,t)}}return U(e.trim(),"",t)}function P(e,t=e.indexOf(":")){let s=e.indexOf("!important",t+1);return Q(e.slice(0,t).trim(),e.slice(t+1,s===-1?e.length:s).trim(),s!==-1)}var Ne=64;function $e(e,t=[]){return{kind:"rule",selector:e,nodes:t}}function U(e,t="",s=[]){return{kind:"at-rule",name:e,params:t,nodes:s}}function H(e,t=[]){return e.charCodeAt(0)===Ne?w(e,t):$e(e,t)}function Q(e,t,s=!1){return{kind:"declaration",property:e,value:t,important:s}}function Y(e){return{kind:"comment",value:e}}function _(e,t,s=[],r={}){for(let n=0;n<e.length;n++){let i=e[n],o=[...s,i],a=s.at(-1)??null;if(i.kind==="context"){if(_(i.nodes,t,s,{...r,...i.context})===2)return 2;continue}let l=t(i,{parent:a,context:r,path:o,replaceWith(c){e.splice(n,1,...Array.isArray(c)?c:[c]),n--}})??0;if(l===2)return 2;if(l!==1&&(i.kind==="rule"||i.kind==="at-rule")&&_(i.nodes,t,o,r)===2)return 2}}function X(e){function t(r,n=0){let i="",o="  ".repeat(n);if(r.kind==="declaration")i+=`${o}${r.property}: ${r.value}${r.important?" !important":""};
`;else if(r.kind==="rule"){i+=`${o}${r.selector} {
`;for(let a of r.nodes)i+=t(a,n+1);i+=`${o}}
`}else if(r.kind==="at-rule"){if(r.nodes.length===0)return`${o}${r.name} ${r.params};
`;i+=`${o}${r.name}${r.params?` ${r.params} `:" "}{
`;for(let a of r.nodes)i+=t(a,n+1);i+=`${o}}
`}else if(r.kind==="comment")i+=`${o}/*${r.value}*/
`;else if(r.kind==="context"||r.kind==="at-root")return"";return i}let s="";for(let r of e){let n=t(r);n!==""&&(s+=n)}return s}function be(e,t){if(typeof e!="string")throw new TypeError("expected path to be a string");if(e==="\\"||e==="/")return"/";var s=e.length;if(s<=1)return e;var r="";if(s>4&&e[3]==="\\"){var n=e[2];(n==="?"||n===".")&&e.slice(0,2)==="\\\\"&&(e=e.slice(2),r="//")}var i=e.split(/[/\\]+/);return t!==!1&&i[i.length-1]===""&&i.pop(),r+i.join("/")}function O(e){let t=be(e);return e.startsWith("\\\\")&&t.startsWith("/")&&!t.startsWith("//")?`/${t}`:t}var j=/(?<!@import\s+)(?<=^|[^\w\-\u0080-\uffff])url\((\s*('[^']+'|"[^"]+")\s*|[^'")]+)\)/,V=/(?<=image-set\()((?:[\w-]{1,256}\([^)]*\)|[^)])*)(?=\))/,Pe=/(?:gradient|element|cross-fade|image)\(/,De=/^\s*data:/i,Ue=/^([a-z]+:)?\/\//,Oe=/^[A-Z_][.\w-]*\(/i,Te=/(?:^|\s)(?<url>[\w-]+\([^)]*\)|"[^"]*"|'[^']*'|[^,]\S*[^,])\s*(?:\s(?<descriptor>\w[^,]+))?(?:,|$)/g,je=/(?<!\\)"/g,Ie=/(?: |\\t|\\n|\\f|\\r)+/g,Fe=e=>De.test(e),Le=e=>Ue.test(e);async function Z({css:e,base:t,root:s}){if(!e.includes("url(")&&!e.includes("image-set("))return e;let r=q(e),n=[];function i(o){if(o[0]==="/")return o;let a=T.posix.join(O(t),o),l=T.posix.relative(O(s),a);return l.startsWith(".")||(l="./"+l),l}return _(r,o=>{if(o.kind!=="declaration"||!o.value)return;let a=j.test(o.value),l=V.test(o.value);if(a||l){let c=l?Me:ee;n.push(c(o.value,i).then(f=>{o.value=f}))}}),n.length&&await Promise.all(n),X(r)}function ee(e,t){return re(e,j,async s=>{let[r,n]=s;return await te(n.trim(),r,t)})}async function Me(e,t){return await re(e,V,async s=>{let[,r]=s;return await Be(r,async({url:i})=>j.test(i)?await ee(i,t):Pe.test(i)?i:await te(i,i,t))})}async function te(e,t,s,r="url"){let n="",i=e[0];if((i==='"'||i==="'")&&(n=i,e=e.slice(1,-1)),We(e))return t;let o=await s(e);return n===""&&o!==encodeURI(o)&&(n='"'),n==="'"&&o.includes("'")&&(n='"'),n==='"'&&o.includes('"')&&(o=o.replace(je,'\\"')),`${r}(${n}${o}${n})`}function We(e){return Le(e)||Fe(e)||e[0]==="#"||Oe.test(e)}function Be(e,t){return Promise.all(ze(e).map(async({url:s,descriptor:r})=>({url:await t({url:s,descriptor:r}),descriptor:r}))).then(Ge)}function ze(e){let t=e.trim().replace(Ie," ").replace(/\r?\n/,"").replace(/,\s+/,", ").replaceAll(/\s+/g," ").matchAll(Te);return Array.from(t,({groups:s})=>({url:s?.url?.trim()??"",descriptor:s?.descriptor?.trim()??""})).filter(({url:s})=>!!s)}function Ge(e){return e.map(({url:t,descriptor:s})=>t+(s?` ${s}`:"")).join(", ")}async function re(e,t,s){let r,n=e,i="";for(;r=t.exec(n);)i+=n.slice(0,r.index),i+=await s(r),n=n.slice(r.index+r[0].length);return i+=n,i}function ce({base:e,onDependency:t,shouldRewriteUrls:s,customCssResolver:r,customJsResolver:n}){return{base:e,async loadModule(i,o){return ue(i,o,t,n)},async loadStylesheet(i,o){let a=await de(i,o,t,r);return s&&(a.content=await Z({css:a.content,root:o,base:a.base})),a}}}async function fe(e,t){if(e.root&&e.root!=="none"){let s=/[*{]/,r=[];for(let i of e.root.pattern.split("/")){if(s.test(i))break;r.push(i)}if(!await ae.stat(I.resolve(t,r.join("/"))).then(i=>i.isDirectory()).catch(()=>!1))throw new Error(`The \`source(${e.root.pattern})\` does not exist`)}}async function Ye(e,t){let s=await He(e,ce(t));return await fe(s,t.base),s}async function Xe(e,t){let s=await qe(e,ce(t));return await fe(s,t.base),s}async function Ve(e,{base:t}){return Je(e,{base:t,async loadModule(s,r){return ue(s,r,()=>{})},async loadStylesheet(s,r){return de(s,r,()=>{})}})}async function ue(e,t,s,r){if(e[0]!=="."){let a=await le(e,t,r);if(!a)throw new Error(`Could not resolve '${e}' from '${t}'`);let l=await oe(ne(a).href);return{base:se(a),module:l.default??l}}let n=await le(e,t,r);if(!n)throw new Error(`Could not resolve '${e}' from '${t}'`);let[i,o]=await Promise.all([oe(ne(n).href+"?id="+Date.now()),z(n)]);for(let a of o)s(a);return{base:se(n),module:i.default??i}}async function de(e,t,s,r){let n=await et(e,t,r);if(!n)throw new Error(`Could not resolve '${e}' from '${t}'`);if(s(n),typeof globalThis.__tw_readFile=="function"){let o=await globalThis.__tw_readFile(n,"utf-8");if(o)return{base:I.dirname(n),content:o}}let i=await ae.readFile(n,"utf-8");return{base:I.dirname(n),content:i}}var ie=null;async function oe(e){if(typeof globalThis.__tw_load=="function"){let t=await globalThis.__tw_load(e);if(t)return t}try{return await import(e)}catch{return ie??=Ke(import.meta.url,{moduleCache:!1,fsCache:!1}),await ie.import(e)}}var Ze=A.ResolverFactory.createResolver({fileSystem:new A.CachedInputFileSystem(L,4e3),useSyncFileSystemCalls:!0,extensions:[".css"],mainFields:["style"],conditionNames:["style"]});async function et(e,t,s){if(typeof globalThis.__tw_resolve=="function"){let r=globalThis.__tw_resolve(e,t);if(r)return Promise.resolve(r)}if(s){let r=await s(e,t);if(r)return r}return F(Ze,e,t)}var tt=A.ResolverFactory.createResolver({fileSystem:new A.CachedInputFileSystem(L,4e3),useSyncFileSystemCalls:!0,extensions:[".js",".json",".node",".ts"],conditionNames:["node","import"]}),rt=A.ResolverFactory.createResolver({fileSystem:new A.CachedInputFileSystem(L,4e3),useSyncFileSystemCalls:!0,extensions:[".js",".json",".node",".ts"],conditionNames:["node","require"]});async function le(e,t,s){if(typeof globalThis.__tw_resolve=="function"){let r=globalThis.__tw_resolve(e,t);if(r)return Promise.resolve(r)}if(s){let r=await s(e,t);if(r)return r}return F(tt,e,t).catch(()=>F(rt,e,t))}function F(e,t,s){return new Promise((r,n)=>e.resolve({},s,t,{},(i,o)=>{if(i)return n(i);r(o)}))}if(!process.versions.bun){let e=k.createRequire(import.meta.url);k.register?.(st(e.resolve("@tailwindcss/node/esm-cache-loader")))}export{Qe as Features,Ve as __unstable__loadDesignSystem,Xe as compile,Ye as compileAst,W as env,O as normalizePath};
